<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-datatypes/datatypes-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi5-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi50-report-html.idx --lstlisting -basedef mpi5defs.txt -o mpi50-report.tex mpi-reporthtml.tex 
-->
<title>Commit and Free</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node107">6.1.9. Commit and Free</span></h2>
<a href="node106.htm#Node106"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node98.htm#Node98"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node108.htm#Node108"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node98.htm#Node98"> Derived Datatypes</a>
<b>Next: </b><a href="node108.htm#Node108"> Duplicating a Datatype</a>
<b>Previous: </b><a href="node106.htm#Node106"> True Extent of Datatypes</a>
<p>
  
<P> 
A datatype object has to be <b> committed</b> before it can be used in a  
communication.  
As an argument in datatype constructors, uncommitted and also  
committed datatypes can be used.  
There is no need to commit basic datatypes. They are ``pre-committed.''  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_TYPE_COMMIT(<span style="white-space:nowrap">datatype</span>)</TD></TR>  
<TR><TD><span style="font-size:0.900em;"> INOUT</span> datatype</TD><TD>datatype that is committed (handle)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_Type_commit(MPI_Datatype *datatype) <br></tt>  
  <b> Fortran 2008 binding</b><br>  <tt> MPI_Type_commit(datatype, ierror) <br> TYPE(MPI_Datatype), INTENT(INOUT) :: <span style="white-space:nowrap">datatype</span><br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <b> Fortran binding</b><br>  <tt> MPI_TYPE_COMMIT(DATATYPE, IERROR) <br> <br>INTEGER <span style="white-space:nowrap">DATATYPE</span>, <span style="white-space:nowrap">IERROR</span> <br></tt>  
<P> 
The commit operation commits the datatype, that is, the formal description of  
a communication buffer, not the content of that buffer.  Thus, after a datatype  
has been committed, it can be repeatedly reused to communicate the changing  
content  
of a buffer or, indeed, the content of different buffers, with different  
starting addresses.  
<P> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
The system may ``compile'' at commit time an internal  
representation for the datatype that facilitates  
communication, e.g.,  
change from a compacted representation to a flat representation of the  
datatype, and select the most convenient transfer mechanism.  
<P> 
The optimizations chosen during <font face="sans-serif"> MPI_TYPE_COMMIT</font> may no longer be optimal  
if a session (or the World Model) is initialized or finalized.  
 (<em> End of advice to implementors.</em>) <br> 
<font face="sans-serif"> MPI_TYPE_COMMIT</font>  
will accept a committed datatype;  
in this case, it is equivalent to a no-op.  
<P> 
<br><b> Example</b>  
  
The following code fragment gives examples of using  
<font face="sans-serif"> MPI_TYPE_COMMIT</font>.  
<br> 
<pre style="background-color:#EFEFEF"><tt><b>INTEGER</b> type1, type2 
<b>CALL</b> <b>MPI_TYPE_CONTIGUOUS</b>(5, <b>MPI_REAL</b>, type1, ierr) 
              ! new <b>type</b> object created 
<b>CALL</b> <b>MPI_TYPE_COMMIT</b>(type1, ierr) 
              ! now type1 can be used for communication 
type2 = type1 
              ! type2 can be used for communication 
              ! (it is a handle to same object as type1) 
<b>CALL</b> <b>MPI_TYPE_VECTOR</b>(3, 5, 4, <b>MPI_REAL</b>, type1, ierr) 
              ! new uncommitted <b>type</b> object created 
<b>CALL</b> <b>MPI_TYPE_COMMIT</b>(type1, ierr) 
              ! now type1 can be used anew for communication 
</tt></pre> 
  
  
<P> 
<TABLE><TR><TD COLSPAN=2>MPI_TYPE_FREE(<span style="white-space:nowrap">datatype</span>)</TD></TR>  
<TR><TD><span style="font-size:0.900em;"> INOUT</span> datatype</TD><TD>datatype that is freed (handle)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_Type_free(MPI_Datatype *datatype) <br></tt>  
  <b> Fortran 2008 binding</b><br>  <tt> MPI_Type_free(datatype, ierror) <br> TYPE(MPI_Datatype), INTENT(INOUT) :: <span style="white-space:nowrap">datatype</span><br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <b> Fortran binding</b><br>  <tt> MPI_TYPE_FREE(DATATYPE, IERROR) <br> <br>INTEGER <span style="white-space:nowrap">DATATYPE</span>, <span style="white-space:nowrap">IERROR</span> <br></tt>  
<P> 
Marks the datatype object associated with <font face="sans-serif"> datatype</font> for  
deallocation and sets <font face="sans-serif"> datatype</font> to <font face="sans-serif"> MPI_DATATYPE_NULL</font>.  
Any communication that is currently using this datatype will complete  
normally.  
Freeing a datatype does not affect any other datatype that was  
built from the freed datatype.  The system behaves as if  
input datatype arguments to derived datatype constructors are passed by value.  
<P> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
The implementation may keep a reference count of active communications  
that use the datatype, in order to decide when to free it.  
Also, one may implement constructors of derived datatypes so that they keep  
pointers to their datatype arguments, rather than copying them.  In this  
case, one needs to keep track of active datatype definition references in order  
to know when a datatype object can be freed.  
 (<em> End of advice to implementors.</em>) <br> 

<P>
<hr>
<a href="node106.htm#Node106"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node98.htm#Node98"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node108.htm#Node108"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node98.htm#Node98"> Derived Datatypes</a>
<b>Next: </b><a href="node108.htm#Node108"> Duplicating a Datatype</a>
<b>Previous: </b><a href="node106.htm#Node106"> True Extent of Datatypes</a>
<p>
<HR>
Return to <A HREF="node627.htm">MPI-5.0 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-5.0 of June 9, 2025<BR>
HTML Generated on March 2, 2025
</FONT>
</body>
</html>
