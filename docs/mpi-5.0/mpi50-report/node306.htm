<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-dynamic/dynamic-2-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi5-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi50-report-html.idx --lstlisting -basedef mpi5defs.txt -o mpi50-report.tex mpi-reporthtml.tex 
-->
<title>Releasing Connections</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node306">12.10.4. Releasing Connections</span></h2>
<a href="node305.htm#Node305"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node302.htm#Node302"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node307.htm#Node307"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node302.htm#Node302"> Other Functionality</a>
<b>Next: </b><a href="node307.htm#Node307"> Another Way to Establish <font face="sans-serif"> MPI</font> Communication</a>
<b>Previous: </b><a href="node305.htm#Node305"> <font face="sans-serif"> MPI_APPNUM</font></a>
<p>
  
Before a client and a server connect, they are independent  
<font face="sans-serif"> MPI</font> applications. An error in one does not affect the other.  
After establishing a connection with <font face="sans-serif"> MPI_COMM_CONNECT</font>  
and <font face="sans-serif"> MPI_COMM_ACCEPT</font>, an error in one may  
affect the other.  
It is desirable for a client and a server to be  
able to disconnect, so that an error in one will  
not affect the other. Similarly, it might be desirable for  
a parent and child to disconnect, so that errors  
in the child do not affect the parent, or vice-versa.  
<P> 
<ul> 
 
<li>Two processes are <b> connected</b> if there is a  
communication path (direct or indirect) between them. More precisely:  
  <ol> 
   
1. Two processes are connected if  
  <ol> 
     
1. they both belong  
      to the same communicator (inter- or intra-,  
      including <font face="sans-serif"> MPI_COMM_WORLD</font>) <em> or</em>  
     
<br> 
2. they have previously belonged to a communicator  
      that was freed with <font face="sans-serif"> MPI_COMM_FREE</font> instead  
      of <font face="sans-serif"> MPI_COMM_DISCONNECT</font> <em> or</em>  
     
<br> 
3. they both belong to the group of the same window or  
      file handle.  
  </ol> 
 
<br> 
2. If A is connected to B and B to C, then A is connected to C.  
  </ol> 
 
<li>Two processes are <b> disconnected</b> (also <b> independent</b>)  
if they are not connected.  
 
<li>By the above definitions, connectivity is a transitive  
property, and divides the universe of <font face="sans-serif"> MPI</font> processes into  
disconnected (independent) sets (equivalence classes) of processes.  
 
<li>Processes that are connected, but do not share the same  
<font face="sans-serif"> MPI_COMM_WORLD</font>, may become disconnected (independent) if the  
communication path between them is broken by  
using <font face="sans-serif"> MPI_COMM_DISCONNECT</font>.  
</ul> 
<br> 
The following additional rules apply to  
<font face="sans-serif"> MPI</font> routines in other chapters:  
<ul> 
 
<li><font face="sans-serif"> MPI_FINALIZE</font> is collective over a set of  
connected processes.  
 
<li><font face="sans-serif"> MPI_ABORT</font> does not abort independent processes.  
It may abort all processes in the caller's  
<font face="sans-serif"> MPI_COMM_WORLD</font> (ignoring its <font face="sans-serif"> comm</font>  
argument). Additionally, it may abort connected processes  
as well, though it makes a ``best attempt'' to abort only  
the processes in <font face="sans-serif"> comm</font>.  
 
<li>If a process terminates without calling <font face="sans-serif"> MPI_FINALIZE</font>,  
independent processes are not affected but the effect on  
connected processes is not defined.  
</ul> 
<br> 
 
<br> 
<em> Advice  
        to implementors.</em>  
<P> 
In practice, it may be difficult to distinguish between an <font face="sans-serif"> MPI</font> process failure  
      
      
    and an erroneous program that terminates without calling  
    an <font face="sans-serif"> MPI</font> finalization function: an implementation that defines semantics for  
    process failure management  
    may have to exhibit the behavior defined for <font face="sans-serif"> MPI</font> process  
    failures with such erroneous programs.  
    A high-quality implementation should exhibit a different behavior  
    for erroneous programs and <font face="sans-serif"> MPI</font> process failures.  
 (<em> End of advice to implementors.</em>) <br> 
<TABLE><TR><TD COLSPAN=2>MPI_COMM_DISCONNECT(<span style="white-space:nowrap">comm</span>)</TD></TR>  
<TR><TD><span style="font-size:0.900em;"> INOUT</span> comm</TD><TD>communicator (handle)</TD></TR>  
</TABLE>  
  <b> C binding</b><br>  <tt> int MPI_Comm_disconnect(MPI_Comm *comm) <br></tt>  
  <b> Fortran 2008 binding</b><br>  <tt> MPI_Comm_disconnect(comm, ierror) <br> TYPE(MPI_Comm), INTENT(INOUT) :: <span style="white-space:nowrap">comm</span><br>INTEGER, OPTIONAL, INTENT(OUT) :: <span style="white-space:nowrap">ierror</span> <br></tt>  
  <b> Fortran binding</b><br>  <tt> MPI_COMM_DISCONNECT(COMM, IERROR) <br> <br>INTEGER <span style="white-space:nowrap">COMM</span>, <span style="white-space:nowrap">IERROR</span> <br></tt>  
<P> 
This function waits for all  
<em> decoupled <font face="sans-serif"> MPI</font> activities</em> on <font face="sans-serif"> comm</font>  
to complete internally, deallocates the communicator object, and sets the handle to  
<font face="sans-serif"> MPI_COMM_NULL</font>. It is a collective operation.  
<P> 
It may not be called with the communicator  
<font face="sans-serif"> MPI_COMM_WORLD</font> or <font face="sans-serif"> MPI_COMM_SELF</font>.  
<P> 
<font face="sans-serif"> MPI_COMM_DISCONNECT</font> may be called only if  
all communication is complete and matched, so that buffered  
data can be delivered to its destination. This requirement is  
the same as for <font face="sans-serif"> MPI_FINALIZE</font>.  
This means that before calling <font face="sans-serif"> MPI_COMM_DISCONNECT</font>, all request handles associated  
with <font face="sans-serif"> comm</font> must be freed in the case of nonblocking operations,  
and must be inactive or freed in the case of persistent or partitioned operations  
(i.e., by calling one of the procedures  
<font face="sans-serif"> MPI_{TEST<i>|</i>WAIT}{<i>|</i>ANY<i>|</i>SOME<i>|</i>ALL}</font>  
or <font face="sans-serif"> MPI_REQUEST_FREE</font>).  
<P> 
<font face="sans-serif"> MPI_COMM_DISCONNECT</font> has the same effect as  
<font face="sans-serif"> MPI_COMM_FREE</font>, except that it waits for  
<em> decoupled <font face="sans-serif"> MPI</font> activities</em>  
on <font face="sans-serif"> comm</font> to finish internally,  
disallows any further use of derived inactive persistent requests,  
and enables the  
guarantee about the behavior of disconnected processes.  
The <em> decoupled <font face="sans-serif"> MPI</font> activities</em> also  
include any communication  
that is needed to complete a nonblocking or persistent operation on <font face="sans-serif"> comm</font>  
that was freed with <font face="sans-serif"> MPI_REQUEST_FREE</font>.  
After calling <font face="sans-serif"> MPI_COMM_DISCONNECT</font>, freeing or starting  
an inactive persistent request handle for a communication operation on <font face="sans-serif"> comm</font> is erroneous.  
<P> 
 
<br> 
<em> Advice to users.</em>  
<P> 
To disconnect two processes you may need to call  
<font face="sans-serif"> MPI_COMM_DISCONNECT</font>, <font face="sans-serif"> MPI_WIN_FREE</font>,  
and <font face="sans-serif"> MPI_FILE_CLOSE</font> to remove all communication paths  
between the two processes.  Note that it may be necessary to  
disconnect several communicators (or to free several windows or files)  
before two processes are completely independent.  
 (<em> End of advice to users.</em>) <br> 
 
<br> 
<em> Rationale.</em>  
<P> 
It would be nice to be able to use <font face="sans-serif"> MPI_COMM_FREE</font> instead,  
but that procedure explicitly does not wait for  
<em> decoupled <font face="sans-serif"> MPI</font> activities</em> to complete,  
and it does not disallow freeing or starting of related inactive (but not yet freed)  
persistent request handles.  
 (<em> End of rationale.</em>) <br> 

<P>
<hr>
<a href="node305.htm#Node305"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node302.htm#Node302"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node307.htm#Node307"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node302.htm#Node302"> Other Functionality</a>
<b>Next: </b><a href="node307.htm#Node307"> Another Way to Establish <font face="sans-serif"> MPI</font> Communication</a>
<b>Previous: </b><a href="node305.htm#Node305"> <font face="sans-serif"> MPI_APPNUM</font></a>
<p>
<HR>
Return to <A HREF="node627.htm">MPI-5.0 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-5.0 of June 9, 2025<BR>
HTML Generated on March 2, 2025
</FONT>
</body>
</html>
