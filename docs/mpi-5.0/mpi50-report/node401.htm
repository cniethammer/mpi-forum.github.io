<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-io/io-2-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi5-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi50-report-html.idx --lstlisting -basedef mpi5defs.txt -o mpi50-report.tex mpi-reporthtml.tex 
-->
<title>Subarray Filetype Constructor</title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node401">15.9.2. Subarray Filetype Constructor</span></h2>
<a href="node400.htm#Node400"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node399.htm#Node399"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node402.htm#Node402"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node399.htm#Node399"> Examples</a>
<b>Next: </b><a href="node402.htm#Node402"> Tool Support</a>
<b>Previous: </b><a href="node400.htm#Node400"> Double Buffering with Split Collective I/O</a>
<p>
  
<P> 
  <div style="text-align:center"><P><img width=463 height=534 src="io-array-file.gif" alt="Image file"><P>
</div>  
  <br> 
<b>Figure 38: </b><span id="Figure38">Example array file layout</span><P> 
  
    
<br><b> Example</b>  
  
  
Assume we are writing out a <i>100&times;100</i> 2D array of double  
precision floating point numbers that is  
distributed among 4 processes such that each process has a block of  
25 columns (e.g., process 0 has columns 0--24, process 1 has columns  
25--49, etc.; see Figure <a href="node401.htm#Figure38">38</a>).  
To create the filetypes for each process one could  
use the following C program  
(see Section <a href="node101.htm#Node101">Subarray Datatype Constructor</a>):  
<P> 
<br> 
<pre style="background-color:#EFEFEF"><tt><b>double</b> subarray[100][25]; 
<b>MPI_Datatype</b> filetype; 
<b>int</b> sizes[2], subsizes[2], starts[2]; 
<b>int</b> rank; 
 
<b>MPI_Comm_rank</b>(<b>MPI_COMM_WORLD</b>, &amp;rank); 
sizes[0]=100; sizes[1]=100; 
subsizes[0]=100; subsizes[1]=25; 
starts[0]=0; starts[1]=rank*subsizes[1]; 
 
<b>MPI_Type_create_subarray</b>(2, sizes, subsizes, starts, <b>MPI_ORDER_C</b>, 
                         <b>MPI_DOUBLE</b>, &amp;filetype); 
</tt></pre> 
  
  
<P> 
Or, equivalently in Fortran:  
<P> 
<br><b> Example</b>  
  
[Local subarray for file output in Fortran 90]FortranLocal subarray for file output in Fortran 90@Local subarray for file output in Fortran 90MPI_TYPE_CREATE_SUBARRAY  
Writing out a <i>100&times;100</i> 2D array of double  
precision floating point numbers that is  
distributed among 4 processes such that each process has a block of  
25 columns (e.g., process 0 has columns 0--24, process 1 has columns  
25--49, etc.; see Figure <a href="node401.htm#Figure38">38</a>).  
<br> 
<pre style="background-color:#EFEFEF"><tt><b>double</b> <b>precision</b> subarray(100,25) 
<b>integer</b> filetype, rank, ierror 
<b>integer</b> sizes(2), subsizes(2), starts(2) 
 
<b>call</b> <b>MPI_COMM_RANK</b>(<b>MPI_COMM_WORLD</b>, rank, ierror) 
sizes(1)    = 100 
sizes(2)    = 100 
subsizes(1) = 100 
subsizes(2) = 25 
starts(1)   = 0 
starts(2)   = rank*subsizes(2) 
 
<b>call</b> <b>MPI_TYPE_CREATE_SUBARRAY</b>(2, sizes, subsizes, starts, &amp; 
           <b>MPI_ORDER_FORTRAN</b>, <b>MPI_DOUBLE_PRECISION</b>,       &amp; 
           filetype, ierror) 
</tt></pre> 
  
  
<P> 
The generated filetype will then describe the portion of the file  
contained within the process's subarray with holes for the space taken  
by the other processes.  Figure <a href="node401.htm#Figure39">39</a> shows the  
filetype created for process 1.  
<P> 
  <div style="text-align:center"><P><img width=453 height=388 src="io-array-p1.gif" alt="Image file"><P>
</div>  
  <br> 
<b>Figure 39: </b><span id="Figure39">Example local array filetype for process 1</span><P> 
  
    
  
<P> 
  

<P>
<hr>
<a href="node400.htm#Node400"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node399.htm#Node399"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node402.htm#Node402"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node399.htm#Node399"> Examples</a>
<b>Next: </b><a href="node402.htm#Node402"> Tool Support</a>
<b>Previous: </b><a href="node400.htm#Node400"> Double Buffering with Split Collective I/O</a>
<p>
<HR>
Return to <A HREF="node627.htm">MPI-5.0 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-5.0 of June 9, 2025<BR>
HTML Generated on March 2, 2025
</FONT>
</body>
</html>
