<!DOCTYPE html>
<html lang=en>
<head>
<!-- This file was generated by tohtml from chap-coll/coll-rendered -->
<!-- with the command
tohtml -default -numbers -dosnl -htables -quietlatex -allgif -endpage mpi5-forum-tail.htm -Wnoredef --mpidoc --latexpgm pdflatex --indexfile mpi50-report-html.idx --lstlisting -basedef mpi5defs.txt -o mpi50-report.tex mpi-reporthtml.tex 
-->
<title>Examples using <font face="sans-serif"> MPI_SCATTER</font> and <font face="sans-serif"> MPI_SCATTERV</font></title>
</head>
<body style="background-color:#FFFFFF">
<hr><h2><span id="Node127">7.6.1. Examples using  MPI_SCATTER and  MPI_SCATTERV</span></h2>
<a href="node126.htm#Node126"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node126.htm#Node126"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node128.htm#Node128"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node126.htm#Node126"> Scatter</a>
<b>Next: </b><a href="node128.htm#Node128"> All-Gather</a>
<b>Previous: </b><a href="node126.htm#Node126"> Scatter</a>
<p>
The examples in this section use intra-communicators.  
<P> 
<br><b> Example</b>  
  
The reverse of Example <a href="node125.htm#Node125">Examples using <font face="sans-serif"> MPI_GATHER</font> and <font face="sans-serif"> MPI_GATHERV</font></a>.  
Scatter sets of 100 <tt>int</tt>s from the root to each <font face="sans-serif"> MPI</font> process in the group.  
See Figure <a href="node127.htm#Figure12">12</a>.  
<P> 
<br> 
<pre style="background-color:#EFEFEF"><tt><b>MPI_Comm</b> comm; 
<b>int</b> gsize,*sendbuf; 
<b>int</b> root, rbuf[100]; 
... 
<b>MPI_Comm_size</b>(comm, &amp;gsize); 
sendbuf = (<b>int</b> *)malloc(gsize*100*<b>sizeof</b>(<b>int</b>)); 
... 
<b>MPI_Scatter</b>(sendbuf, 100, <b>MPI_INT</b>, rbuf, 100, <b>MPI_INT</b>, root, comm); 
</tt></pre> 
  
  
<P> 
  <div style="text-align:center"><P><img width=983 height=419 src="mycoll-fig7.gif" alt="Image file"><P>
</div>  
  <br> 
<b>Figure 12: </b><span id="Figure12">The root scatters sets of 100 <tt>int</tt>s 
    to each <font face="sans-serif"> MPI</font> process in the group</span><P> 
  
    
<br><b> Example</b>  
  
The reverse of Example <a href="node125.htm#Node125">Examples using <font face="sans-serif"> MPI_GATHER</font> and <font face="sans-serif"> MPI_GATHERV</font></a>.  
The root scatters sets of 100 <tt>int</tt>s to the other <font face="sans-serif"> MPI</font> processes,  
but the sets of 100 are <tt>stride int</tt>s apart in the sending buffer.  
Requires use of <font face="sans-serif"> MPI_SCATTERV</font>.  
Assume <i>stride &ge; 100</i>.  See Figure <a href="node127.htm#Figure13">13</a>.  
<P> 
<br> 
<pre style="background-color:#EFEFEF"><tt><b>MPI_Comm</b> comm; 
<b>int</b> gsize,*sendbuf; 
<b>int</b> root, rbuf[100], i, *displs, *scounts; 
 
... 
 
<b>MPI_Comm_size</b>(comm, &amp;gsize); 
sendbuf = (<b>int</b> *)malloc(gsize*stride*<b>sizeof</b>(<b>int</b>)); 
... 
displs = (<b>int</b> *)malloc(gsize*<b>sizeof</b>(<b>int</b>)); 
scounts = (<b>int</b> *)malloc(gsize*<b>sizeof</b>(<b>int</b>)); 
<b>for</b> (i=0; i&lt;gsize; ++i) { 
    displs[i] = i*stride; 
    scounts[i] = 100; 
} 
<b>MPI_Scatterv</b>(sendbuf, scounts, displs, <b>MPI_INT</b>, rbuf, 100, <b>MPI_INT</b>, 
             root, comm); 
</tt></pre> 
  
  
<P> 
  <div style="text-align:center"><P><img width=983 height=429 src="mycoll-fig8.gif" alt="Image file"><P>
</div>  
  <br> 
<b>Figure 13: </b><span id="Figure13">The root scatters sets of 
    100 <tt>int</tt>s, moving by 
  <tt>stride int</tt>s from send to send in the scatter</span><P> 
  
    
<br><b> Example</b>  
  
The reverse of Example <a href="node125.htm#Node125">Examples using <font face="sans-serif"> MPI_GATHER</font> and <font face="sans-serif"> MPI_GATHERV</font></a>.  
We have a varying stride between blocks at sending (root) end,  
at the receiving end we receive into the <tt>i</tt>-th column of a 100<i>&times;</i>150  
C array.  
See Figure <a href="node127.htm#Figure14">14</a>.  
<P> 
<br> 
<pre style="background-color:#EFEFEF"><tt><b>MPI_Comm</b> comm; 
<b>int</b> gsize,recvarray[100][150],*rptr; 
<b>int</b> root, *sendbuf, myrank, *stride; 
<b>MPI_Datatype</b> rtype; 
<b>int</b> i, *displs, *scounts, offset; 
... 
<b>MPI_Comm_size</b>(comm, &amp;gsize); 
<b>MPI_Comm_rank</b>(comm, &amp;myrank); 
 
stride = (<b>int</b> *)malloc(gsize*<b>sizeof</b>(<b>int</b>)); 
... 
/* stride[i] <b>for</b> i = 0 to gsize-1 is set somehow 
 * sendbuf comes from elsewhere 
 */ 
... 
displs = (<b>int</b> *)malloc(gsize*<b>sizeof</b>(<b>int</b>)); 
scounts = (<b>int</b> *)malloc(gsize*<b>sizeof</b>(<b>int</b>)); 
offset = 0; 
<b>for</b> (i=0; i&lt;gsize; ++i) { 
    displs[i] = offset; 
    offset += stride[i]; 
    scounts[i] = 100 - i; 
} 
/* Create datatype <b>for</b> the column we are receiving 
 */ 
<b>MPI_Type_vector</b>(100-myrank, 1, 150, <b>MPI_INT</b>, &amp;rtype); 
<b>MPI_Type_commit</b>(&amp;rtype); 
rptr = &amp;recvarray[0][myrank]; 
<b>MPI_Scatterv</b>(sendbuf, scounts, displs, <b>MPI_INT</b>, rptr, 1, rtype, 
             root, comm); 
</tt></pre> 
  
  
<P> 
  <div style="text-align:center"><P><img width=1158 height=531 src="mycoll-fig9.gif" alt="Image file"><P>
</div>  
  <br> 
<b>Figure 14: </b><span id="Figure14">The root 
    scatters blocks of <tt>100-i int</tt>s into 
    column <tt>i</tt> of a 100$ x $150 
    C array.  At the sending side, the blocks are <tt>stride[i] int</tt>s apart.</span><P> 
  
    

<P>
<hr>
<a href="node126.htm#Node126"><img width=16 height=16 src="previous.gif" alt="Previous"></a><a href="node126.htm#Node126"><img width=16 height=16 src="up.gif" alt="Up"></a><a href="node128.htm#Node128"><img width=16 height=16 src="next.gif" alt="Next"></a><br>
<b>Up: </b><a href="node126.htm#Node126"> Scatter</a>
<b>Next: </b><a href="node128.htm#Node128"> All-Gather</a>
<b>Previous: </b><a href="node126.htm#Node126"> Scatter</a>
<p>
<HR>
Return to <A HREF="node627.htm">MPI-5.0 Standard Index</A><BR>
Return to <A HREF="http://www.mpi-forum.org/index.html">MPI Forum Home Page</A><BR>
<HR>
<FONT SIZE=-1>(Unofficial) MPI-5.0 of June 9, 2025<BR>
HTML Generated on March 2, 2025
</FONT>
</body>
</html>
